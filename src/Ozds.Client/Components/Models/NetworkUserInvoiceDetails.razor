@using MudBlazor
@using Microsoft.AspNetCore.Components
@using Ozds.Business.Models
@using Ozds.Client.Components.Base
@using Ozds.Client.Components.Fields

@namespace Ozds.Client.Components.Models

@inherits OzdsComponentBase

<MudText Typo="Typo.h5">
  @Translate("INVOICE FOR"] @(Model.FromDate.Month). @T["MONTH")
</MudText>

<MudPaper class="mt-4 px-4 py-2">
  <MudGrid Spacing="1">
    <MudItem xs="12" sm="12">
      <MudText Typo="Typo.body1">
        <strong>@Translate("ZDS"):</strong>
      </MudText>
    </MudItem>
    <MudItem xs="12" sm="12">
      <MudText Typo="Typo.body1" Align="Align.Left">
        @(Model.ArchivedLocation.Title)
      </MudText>
    </MudItem>
    <MudItem xs="12" sm="12">
      <MudText Typo="Typo.body1">
        <strong>@Translate("User"):</strong>
      </MudText>
    </MudItem>
    <MudItem xs="12" sm="12">
      <MudText Typo="Typo.body1" Align="Align.Left">
        @(Model.ArchivedNetworkUser.Title)
      </MudText>
    </MudItem>
    <MudItem xs="12" sm="12">
      <MudText Typo="Typo.body1">
        <strong>@Translate("From"):</strong>
      </MudText>
    </MudItem>
    <MudItem xs="12" sm="12">
      <MudText Typo="Typo.body1" Align="Align.Left">
        @DateTimeString(Model.FromDate)
      </MudText>
    </MudItem>
    <MudItem xs="12" sm="12">
      <MudText Typo="Typo.body1">
        <strong>@Translate("To"):</strong>
      </MudText>
    </MudItem>
    <MudItem xs="12" sm="12">
      <MudText Typo="Typo.body1" Align="Align.Left">
        @DateTimeString(Model.ToDate)
      </MudText>
    </MudItem>
  </MudGrid>
</MudPaper>

<MudItem Class="d-flex flex-row justify-space-between mt-8">
  <MudText Typo="Typo.h5">
    @Translate("Grid fee")
  </MudText>
  <MudText Typo="Typo.h5" Class="mr-4">
    EUR
  </MudText>
</MudItem>
@{
  var usageRows = new[]
  {
    (
      Name: Translate("Network usage during the period of a single daily tariff"),
      Total: Model.UsageActiveEnergyTotalImportT0Fee_EUR
    ),
    (
      Name: Translate("Network usage during the period of a higher daily tariff"),
      Total: Model.UsageActiveEnergyTotalImportT1Fee_EUR
    ),
    (
      Name: Translate("Network usage during the period of a lower daily tariff"),
      Total: Model.UsageActiveEnergyTotalImportT2Fee_EUR
    ),
    (
      Name: Translate("Engaged power during the period of a higher tariff"),
      Total: Model.UsageActivePowerTotalImportT1PeakFee_EUR
    ),
    (
      Name: Translate("Excessively drawn reactive power"),
      Total: Model.UsageReactiveEnergyTotalRampedT0Fee_EUR
    ),
    (
      Name: Translate("Measurement service fee"),
      Total: Model.UsageMeterFee_EUR
    )
  };
}
@foreach (var row in usageRows)
{
  <MudPaper class="mt-2 px-4 py-2">
    <MudGrid Spacing="1">
      <MudItem xs="12" sm="6">
        <MudText Typo="Typo.body1">
          @(row.Name)
        </MudText>
      </MudItem>
      <MudItem xs="12" sm="6">
        <MudHidden Breakpoint="Breakpoint.Xs">
          <MudText Typo="Typo.body1" Align="Align.Right">
            @NumericString(row.Total)
          </MudText>
        </MudHidden>
        <MudHidden Breakpoint="Breakpoint.SmAndUp">
          <MudText Typo="Typo.body1" Align="Align.Left">
            @NumericString(row.Total)
          </MudText>
        </MudHidden>
      </MudItem>
    </MudGrid>
  </MudPaper>
}
<MudText Typo="Typo.subtitle1" class="mt-2" Align="Align.Right">
  @Translate("TOTAL") @NumericString(Model.UsageFeeTotal_EUR) EUR
</MudText>

<MudItem Class="d-flex flex-row justify-space-between mt-8">
  <MudText Typo="Typo.h5">
    @Translate("Supply")
  </MudText>
  <MudText Typo="Typo.h5" Class="mr-4">
    EUR
  </MudText>
</MudItem>
@{
  var supplyRows = new[]
  {
    (
      Name: Translate("Electricity supply during the period of a higher daily tariff"),
      Total: Model.SupplyActiveEnergyTotalImportT1Fee_EUR
    ),
    (
      Name: Translate("Electricity supply during the period of a lower daily tariff"),
      Total: Model.SupplyActiveEnergyTotalImportT2Fee_EUR
    ),
    (
      Name: Translate("Fee for promoting production from renewable energy sources and cogeneration"),
      Total: Model.SupplyRenewableEnergyFee_EUR
    ),
    (
      Name: Translate("Excise duty for business/non-business use"),
      Total: Model.SupplyBusinessUsageFee_EUR
    )
  };
}
@foreach (var row in supplyRows)
{
  <MudPaper class="mt-2 px-4 py-2">
    <MudGrid Spacing="1">
      <MudItem xs="12" sm="6">
        <MudText Typo="Typo.body1">
          @(row.Name)
        </MudText>
      </MudItem>
      <MudItem xs="12" sm="6">
        <MudHidden Breakpoint="Breakpoint.Xs">
          <MudText Typo="Typo.body1" Align="Align.Right">
            @NumericString(row.Total)
          </MudText>
        </MudHidden>
        <MudHidden Breakpoint="Breakpoint.SmAndUp">
          <MudText Typo="Typo.body1" Align="Align.Left">
            @NumericString(row.Total)
          </MudText>
        </MudHidden>
      </MudItem>
    </MudGrid>
  </MudPaper>
}
<MudText Typo="Typo.subtitle1" class="mt-2" Align="Align.Right">
  @Translate("TOTAL") @NumericString(Model.SupplyFeeTotal_EUR) EUR
</MudText>

<MudItem Class="d-flex flex-row justify-space-between mt-8">
  <MudText Typo="Typo.h5">

  </MudText>
  <MudText Typo="Typo.h5" Class="mr-4">
    EUR
  </MudText>
</MudItem>
<MudPaper class="px-4 py-2">
  <MudGrid Spacing="1">
    <MudItem xs="12" sm="9">
      <MudText Typo="Typo.h5">
        <strong>@Translate("Total")</strong>
      </MudText>
    </MudItem>
    <MudItem xs="12" sm="3">
      <MudHidden Breakpoint="Breakpoint.Xs">
        <MudText Typo="Typo.h5" Align="Align.Right">
          @NumericString(Model.Total_EUR) EUR
        </MudText>
      </MudHidden>
      <MudHidden Breakpoint="Breakpoint.SmAndUp">
        <MudText Typo="Typo.h5" Align="Align.Left">
          @NumericString(Model.Total_EUR) EUR
        </MudText>
      </MudHidden>
    </MudItem>
    <MudItem xs="12" sm="9">
      <MudText Typo="Typo.h5">

        <strong>
          @Translate("VAT") (@NumericString(
                        Model.ArchivedRegulatoryCatalogue.TaxRate_Percent
                      )%)
        </strong>
      </MudText>
    </MudItem>
    <MudItem xs="12" sm="3">
      <MudHidden Breakpoint="Breakpoint.Xs">
        <MudText Typo="Typo.h5" Align="Align.Right">
          @NumericString(Model.Tax_EUR) EUR
        </MudText>
      </MudHidden>
      <MudHidden Breakpoint="Breakpoint.SmAndUp">
        <MudText Typo="Typo.h5" Align="Align.Left">
          @NumericString(Model.Tax_EUR) EUR
        </MudText>
      </MudHidden>
    </MudItem>
    <MudItem xs="12" sm="9">
      <MudText Typo="Typo.h5">
        <strong>@Translate("Full total")</strong>
      </MudText>
    </MudItem>
    <MudItem xs="12" sm="3">
      <MudHidden Breakpoint="Breakpoint.Xs">
        <MudText Typo="Typo.h5" Align="Align.Right">
          @NumericString(Model.TotalWithTax_EUR) EUR
        </MudText>
      </MudHidden>
      <MudHidden Breakpoint="Breakpoint.SmAndUp">
        <MudText Typo="Typo.h5" Align="Align.Left">
          @NumericString(Model.TotalWithTax_EUR) EUR
        </MudText>
      </MudHidden>
    </MudItem>
  </MudGrid>
</MudPaper>

@code {
  [Parameter]
  public NetworkUserInvoiceModel Model { get; set; } = default!;
}
