@using MudBlazor
@using Ozds.Client.Components.Base
@using Ozds.Client.Components.Fields
@using Ozds.Client.Components.Models

@namespace Ozds.Client.Components.Providers

@inherits OzdsOwningComponentBase

@if (_state is { } state)
{
  <CascadingValue Value="_state">
    @ChildContent
  </CascadingValue>
  return;
}

<MudContainer MaxWidth="@MaxWidth.Small">
  <MudText Class="mt-12" Typo="@Typo.h5">
    @Translate("Please select a location")
  </MudText>

  <div class="d-flex flex-column my-auto">
    <MudTextField
      Placeholder="@Translate("Type here to search...")"
      Adornment="Adornment.Start"
      AdornmentIcon="@Icons.Material.Filled.Search"
      @bind-Value="_filter" />

    <MudList>
      @foreach (var location in _representativeLocations)
      {
        @if (
          !string.IsNullOrWhiteSpace(_filter) &&
          !location.Title.StartsWith(_filter))
        {
          continue;
        }

        <MudListItem>
          <MudButton OnClick="@(() => OnLocationSelected(location))">
            <LocationSummary Model="location" />
          </MudButton>
        </MudListItem>
      }
    </MudList>
  </div>
</MudContainer>
